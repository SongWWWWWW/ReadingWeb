# 数据库安装指南

## 一、创建数据库

### 1. 登录 MySQL

```bash
mysql -u root -p
```

### 2. 创建数据库

```sql
CREATE DATABASE IF NOT EXISTS reading_web 
DEFAULT CHARACTER SET utf8mb4 
COLLATE utf8mb4_unicode_ci;
```

### 3. 使用数据库

```sql
USE reading_web;
```

### 4. 执行 SQL 脚本

有两种方式：

#### 方式1：在 MySQL 命令行中执行

```sql
SOURCE src/main/resources/db/schema.sql;
```

#### 方式2：使用命令行直接执行

```bash
mysql -u root -p reading_web < src/main/resources/db/schema.sql
```

## 二、使用图形化工具（推荐）

### 使用 Navicat、DBeaver、MySQL Workbench 等工具

1. **连接数据库**
   - 打开数据库管理工具
   - 连接到 MySQL 服务器

2. **创建数据库**
   - 右键点击连接
   - 选择"新建数据库"
   - 数据库名：`reading_web`
   - 字符集：`utf8mb4`
   - 排序规则：`utf8mb4_unicode_ci`

3. **执行 SQL 脚本**
   - 打开 `src/main/resources/db/schema.sql` 文件
   - 复制所有 SQL 语句
   - 在工具中执行 SQL 脚本
   - 或者使用工具的"执行 SQL 文件"功能

## 三、验证数据库表

执行以下 SQL 查询，确认表已创建：

```sql
-- 查看所有表
SHOW TABLES;

-- 查看表结构
DESC user;
DESC book;
DESC chapter;
DESC category;
DESC reading_record;
DESC favorite;

-- 查看分类数据
SELECT * FROM category;
```

## 四、数据库表说明

项目包含以下6张表：

1. **user** - 用户表
   - 存储用户基本信息（用户名、密码、邮箱、昵称等）

2. **category** - 分类表
   - 存储书籍分类信息
   - 已预置8个默认分类（玄幻、都市、历史等）

3. **book** - 书籍表
   - 存储书籍基本信息（书名、作者、简介、封面等）

4. **chapter** - 章节表
   - 存储章节内容
   - 关联书籍ID

5. **reading_record** - 阅读记录表
   - 记录用户的阅读进度

6. **favorite** - 收藏表
   - 记录用户收藏的书籍

## 五、配置数据库连接

在 `src/main/resources/application.yml` 中配置数据库连接信息：

```yaml
spring:
  datasource:
    url: jdbc:mysql://localhost:3306/reading_web?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowPublicKeyRetrieval=true
    username: root
    password: your_password  # 修改为你的MySQL密码
```

## 六、常见问题

### 问题1：字符集错误
如果遇到中文乱码，确保：
- 数据库字符集为 `utf8mb4`
- 连接URL中包含 `useUnicode=true&characterEncoding=utf8`

### 问题2：时区错误
如果遇到时区问题，在连接URL中添加：
```
&serverTimezone=Asia/Shanghai
```

### 问题3：权限不足
确保数据库用户有创建表和插入数据的权限：
```sql
GRANT ALL PRIVILEGES ON reading_web.* TO 'your_user'@'localhost';
FLUSH PRIVILEGES;
```

## 七、快速验证

创建数据库后，可以执行以下测试：

```sql
-- 查看表数量（应该返回6）
SELECT COUNT(*) as table_count 
FROM information_schema.tables 
WHERE table_schema = 'reading_web';

-- 查看分类数据（应该返回8条）
SELECT COUNT(*) FROM category;
```

